trans = "log10") +
scale_y_continuous(limits = ylim, labels=formatter) +
guides(colour=guide_legend(title = "Strains",nrow=2)) +
# ggtitle(plot_title) +
xlab(xlabel) +
ylab(expression(paste("Fluorescence x","10"^"3","(a.u.)",sep=""))) +
theme(panel.grid.minor = element_blank(),
legend.direction = "horizontal", legend.position = "none",
panel.border = element_blank(),
axis.line = element_line(),
# axis.text = element_text(size=24),
# axis.title = element_text(size=24),
axis.title = element_text(hjust = 1),
panel.background = element_blank()
)
# geom_rangeframe(aes(x=c(min(x_values):max(x_values)),
#                     y=seq(0,50,length.out=length(c(min(x_values):max(x_values))))),sides = "lb")
return(pretty_plot)
}
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_plot<-f_plot_sigmoid_curves_single(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim,ec_list,strain_list)
sigmoid_fit_parameters
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
length(frame_list)
length(sigmoid_fit_parameters)
length(starting_well)
length(list_of_starting_points)
list_of_starting_points<-list(
c(30000,0.8,20,1,5000),
c(7000,0.1,2,1,5000),
c(40000,0.5,5,1,5000),
c(40000,0.5,2,1,5000))
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_plot<-f_plot_sigmoid_curves_single(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim,ec_list,strain_list)
length(ec_list)
strain_list<-label_list_sigmoid
# apply the fitting to each frame with its own individual starting points.
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_plot<-f_plot_sigmoid_curves_single(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim,ec_list,strain_list)
sigmoid_plot
f_plot_sigmoid_curves_overlaid<-
# plot the fitted line and the individual data points.
function(fit_list,frame_list, control_frame_list,dose_control,label_list_control, xlim, ylim,doses){
formatter<-function(x){x/1000}
final_plot<-ggplot()
# plot the lines
for (i in c(1:length(fit_list))){
print(i)
single_layer_line<- geom_line(aes_(x=x_values, y=fit_list[[i]],
colour=label_list_sigmoid[[i]]), size=1)
final_plot<-final_plot+single_layer_line
}
# plot the individual data points
for (j in c(1:length(frame_list))){
single_layer_point<- geom_point(aes_(x=frame_list[[j]][,8],y=frame_list[[j]][,1],
colour=label_list_sigmoid[[j]]))
final_plot<-final_plot+single_layer_point
}
# plot the controls
for(k in c(1:length(control_frame_list))){
frame<-control_frame_list[[k]][which(control_frame_list[[k]][,8]==dose_control),]
single_layer_control<- geom_hline(aes_(yintercept=frame[,1],
linetype=label_list_control[[k]]), colour="black")
ribbon_layer_control<- geom_ribbon(aes_(ymin=frame[,1]-(frame[,6]*frame[,1]),
ymax=frame[,1]-(frame[,6]*frame[,1]),
x=x_values))
final_plot<-final_plot+single_layer_control
}
pretty_plot<-final_plot +
scale_linetype_manual(values=c("longdash","dotdash")) +
scale_colour_manual(values = colour_palette) +
scale_x_continuous(breaks = doses_experiment,
labels = labels_x_axis,
limits = xlim,
trans = "log10") +
scale_y_continuous(limits = ylim, labels=formatter) +
guides(colour=guide_legend(title = "Strains",nrow=2)) +
# ggtitle(plot_title) +
xlab(xlabel) +
ylab(expression(paste("Fluorescence x","10"^"3","(a.u.)",sep=""))) +
theme(panel.grid.minor = element_blank(),
legend.direction = "horizontal", legend.position = "none",
panel.border = element_blank(),
axis.line = element_line(),
# axis.text = element_text(size=24),
# axis.title = element_text(size=24),
axis.title = element_text(hjust = 1),
panel.background = element_blank()
)
# geom_rangeframe(aes(x=c(min(x_values):max(x_values)),
#                     y=seq(0,50,length.out=length(c(min(x_values):max(x_values))))),sides = "lb")
return(pretty_plot)
}
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim)
sigmoid_plot
label_list_control<-c("ype_norepressor","ype_70",
"gly_norepressor","gly_70",
"pro_norepressor","pro_70",
"sd_norepressor","sd_70")
control_frame_error<-df_list[control_descriptives_to_use]
# pick your controls
control_frame_list<-descriptives[control_descriptives_to_use]
for(i in c(2,3)){
control_frame_list[[i]][,1]<-control_frame_list[[i]][,1]
}
#define x axis doses and the labels for plotting
doses_experiment<-c(0.1,1,5,20,60,200)
labels_x_axis<- c("0","1","5","20","60","200")
# replace 0 values in the doses with 0.1
for(i in c(1:length(frame_list))){
frame_list[[i]][1,8]<-0.1
}
# generate log distributed x values for smoother line fitting.
library(emdbook)
x_values<-lseq(min(frame_list[[1]][,8]),
max(frame_list[[1]][,8]),1000)
strain_list<-label_list_sigmoid
# apply the fitting to each frame with its own individual starting points.
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim)
sigmoid_plot
control_frame_list<-descriptives[control_descriptives_to_use]
#define x axis doses and the labels for plotting
doses_experiment<-c(0.1,1,5,20,60,200)
labels_x_axis<- c("0","1","5","20","60","200")
# replace 0 values in the doses with 0.1
for(i in c(1:length(frame_list))){
frame_list[[i]][1,8]<-0.1
}
# generate log distributed x values for smoother line fitting.
library(emdbook)
x_values<-lseq(min(frame_list[[1]][,8]),
max(frame_list[[1]][,8]),1000)
strain_list<-label_list_sigmoid
# apply the fitting to each frame with its own individual starting points.
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim)
sigmoid_plot
control_frame_list
dose_control<-"0"
strain_list<-label_list_sigmoid
# apply the fitting to each frame with its own individual starting points.
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim)
sigmoid_plot
f_plot_sigmoid_curves_overlaid<-
# plot the fitted line and the individual data points.
function(fit_list,frame_list, control_frame_list,dose_control,label_list_control, xlim, ylim,doses){
formatter<-function(x){x/1000}
final_plot<-ggplot()
# plot the lines
for (i in c(1:length(fit_list))){
single_layer_line<- geom_line(aes_(x=x_values, y=fit_list[[i]],
colour=label_list_sigmoid[[i]]), size=1)
final_plot<-final_plot+single_layer_line
}
# plot the individual data points
for (j in c(1:length(frame_list))){
single_layer_point<- geom_point(aes_(x=frame_list[[j]][,8],y=frame_list[[j]][,1],
colour=label_list_sigmoid[[j]]))
final_plot<-final_plot+single_layer_point
}
# plot the controls
for(k in c(1:length(control_frame_list))){
frame<-control_frame_list[[k]][which(control_frame_list[[k]][,8]==dose_control),]
single_layer_control<- geom_hline(aes_(yintercept=frame[,1],
linetype=label_list_control[[k]]), colour="black")
ribbon_layer_control<- geom_ribbon(aes_(ymin=frame[,1]-(frame[,6]*frame[,1]),
ymax=frame[,1]-(frame[,6]*frame[,1]),
x=x_values))
final_plot<-final_plot+single_layer_control
}
pretty_plot<-final_plot +
scale_linetype_manual(values=c("longdash","dotdash",
"longdash","dotdash",
"longdash","dotdash",
"longdash","dotdash")) +
scale_colour_manual(values = colour_palette) +
scale_x_continuous(breaks = doses_experiment,
labels = labels_x_axis,
limits = xlim,
trans = "log10") +
scale_y_continuous(limits = ylim, labels=formatter) +
guides(colour=guide_legend(title = "Strains",nrow=2)) +
# ggtitle(plot_title) +
xlab(xlabel) +
ylab(expression(paste("Fluorescence x","10"^"3","(a.u.)",sep=""))) +
theme(panel.grid.minor = element_blank(),
legend.direction = "horizontal", legend.position = "none",
panel.border = element_blank(),
axis.line = element_line(),
# axis.text = element_text(size=24),
# axis.title = element_text(size=24),
axis.title = element_text(hjust = 1),
panel.background = element_blank()
)
# geom_rangeframe(aes(x=c(min(x_values):max(x_values)),
#                     y=seq(0,50,length.out=length(c(min(x_values):max(x_values))))),sides = "lb")
return(pretty_plot)
}
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim)
sigmoid_plot
round(1/2,1)
round(1/2,0)
round(1/2,2)
?round
signif(0.5,1)
signif(0.5,0)
signif(0.5,2)
signif(0.5,3)
ceiling(0.5)
ceiling(0.4)
ceiling(1)
f_plot_sigmoid_curves_overlaid<-
# plot the fitted line and the individual data points.
function(fit_list,frame_list, control_frame_list,dose_control,label_list_control, xlim, ylim,doses){
formatter<-function(x){x/1000}
final_plot<-ggplot()
# plot the lines
for (i in c(1:length(fit_list))){
single_layer_line<- geom_line(aes_(x=x_values, y=fit_list[[i]],
colour=label_list_sigmoid[[i]]), size=1)
final_plot<-final_plot+single_layer_line
}
# plot the individual data points
for (j in c(1:length(frame_list))){
single_layer_point<- geom_point(aes_(x=frame_list[[j]][,8],y=frame_list[[j]][,1],
colour=label_list_sigmoid[[j]]))
final_plot<-final_plot+single_layer_point
}
# plot the controls
for(k in c(1:length(control_frame_list))){
frame<-control_frame_list[[k]][which(control_frame_list[[k]][,8]==dose_control),]
single_layer_control<- geom_hline(aes_(yintercept=frame[,1],
linetype=label_list_control[[k]],colour=
label_list_sigmoid[[ceiling(k/2,1)]]))
ribbon_layer_control<- geom_ribbon(aes_(ymin=frame[,1]-(frame[,6]*frame[,1]),
ymax=frame[,1]-(frame[,6]*frame[,1]),
x=x_values))
final_plot<-final_plot+single_layer_control
}
pretty_plot<-final_plot +
scale_linetype_manual(values=c("longdash","dotdash",
"longdash","dotdash",
"longdash","dotdash",
"longdash","dotdash")) +
scale_colour_manual(values = colour_palette) +
scale_x_continuous(breaks = doses_experiment,
labels = labels_x_axis,
limits = xlim,
trans = "log10") +
scale_y_continuous(limits = ylim, labels=formatter) +
guides(colour=guide_legend(title = "Strains",nrow=2)) +
# ggtitle(plot_title) +
xlab(xlabel) +
ylab(expression(paste("Fluorescence x","10"^"3","(a.u.)",sep=""))) +
theme(panel.grid.minor = element_blank(),
legend.direction = "horizontal", legend.position = "none",
panel.border = element_blank(),
axis.line = element_line(),
# axis.text = element_text(size=24),
# axis.title = element_text(size=24),
axis.title = element_text(hjust = 1),
panel.background = element_blank()
)
# geom_rangeframe(aes(x=c(min(x_values):max(x_values)),
#                     y=seq(0,50,length.out=length(c(min(x_values):max(x_values))))),sides = "lb")
return(pretty_plot)
}
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim)
f_plot_sigmoid_curves_overlaid<-
# plot the fitted line and the individual data points.
function(fit_list,frame_list, control_frame_list,dose_control,label_list_control, xlim, ylim,doses){
formatter<-function(x){x/1000}
final_plot<-ggplot()
# plot the lines
for (i in c(1:length(fit_list))){
single_layer_line<- geom_line(aes_(x=x_values, y=fit_list[[i]],
colour=label_list_sigmoid[[i]]), size=1)
final_plot<-final_plot+single_layer_line
}
# plot the individual data points
for (j in c(1:length(frame_list))){
single_layer_point<- geom_point(aes_(x=frame_list[[j]][,8],y=frame_list[[j]][,1],
colour=label_list_sigmoid[[j]]))
final_plot<-final_plot+single_layer_point
}
# plot the controls
for(k in c(1:length(control_frame_list))){
frame<-control_frame_list[[k]][which(control_frame_list[[k]][,8]==dose_control),]
single_layer_control<- geom_hline(aes_(yintercept=frame[,1],
linetype=label_list_control[[k]],colour=
label_list_sigmoid[[ceiling(k/2)]]))
ribbon_layer_control<- geom_ribbon(aes_(ymin=frame[,1]-(frame[,6]*frame[,1]),
ymax=frame[,1]-(frame[,6]*frame[,1]),
x=x_values))
final_plot<-final_plot+single_layer_control
}
pretty_plot<-final_plot +
scale_linetype_manual(values=c("longdash","dotdash",
"longdash","dotdash",
"longdash","dotdash",
"longdash","dotdash")) +
scale_colour_manual(values = colour_palette) +
scale_x_continuous(breaks = doses_experiment,
labels = labels_x_axis,
limits = xlim,
trans = "log10") +
scale_y_continuous(limits = ylim, labels=formatter) +
guides(colour=guide_legend(title = "Strains",nrow=2)) +
# ggtitle(plot_title) +
xlab(xlabel) +
ylab(expression(paste("Fluorescence x","10"^"3","(a.u.)",sep=""))) +
theme(panel.grid.minor = element_blank(),
legend.direction = "horizontal", legend.position = "none",
panel.border = element_blank(),
axis.line = element_line(),
# axis.text = element_text(size=24),
# axis.title = element_text(size=24),
axis.title = element_text(hjust = 1),
panel.background = element_blank()
)
# geom_rangeframe(aes(x=c(min(x_values):max(x_values)),
#                     y=seq(0,50,length.out=length(c(min(x_values):max(x_values))))),sides = "lb")
return(pretty_plot)
}
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
dose_control, label_list_control, xlim, ylim)
sigmoid_plot
control_frame_list
dose_control<-c("400","400","200","200","200","200","400","400")
f_plot_sigmoid_curves_overlaid<-
# plot the fitted line and the individual data points.
function(fit_list,frame_list, control_frame_list,label_list_control, xlim, ylim,control_doses){
formatter<-function(x){x/1000}
final_plot<-ggplot()
# plot the lines
for (i in c(1:length(fit_list))){
single_layer_line<- geom_line(aes_(x=x_values, y=fit_list[[i]],
colour=label_list_sigmoid[[i]]), size=1)
final_plot<-final_plot+single_layer_line
}
# plot the individual data points
for (j in c(1:length(frame_list))){
single_layer_point<- geom_point(aes_(x=frame_list[[j]][,8],y=frame_list[[j]][,1],
colour=label_list_sigmoid[[j]]))
final_plot<-final_plot+single_layer_point
}
# plot the controls
for(k in c(1:length(control_frame_list))){
dose_control<-control_doses[[k]]
frame<-control_frame_list[[k]][which(control_frame_list[[k]][,8]==dose_control),]
single_layer_control<- geom_hline(aes_(yintercept=frame[,1],
linetype=label_list_control[[k]],colour=
label_list_sigmoid[[ceiling(k/2)]]))
ribbon_layer_control<- geom_ribbon(aes_(ymin=frame[,1]-(frame[,6]*frame[,1]),
ymax=frame[,1]-(frame[,6]*frame[,1]),
x=x_values))
final_plot<-final_plot+single_layer_control
}
pretty_plot<-final_plot +
scale_linetype_manual(values=c("longdash","dotdash",
"longdash","dotdash",
"longdash","dotdash",
"longdash","dotdash")) +
scale_colour_manual(values = colour_palette) +
scale_x_continuous(breaks = doses_experiment,
labels = labels_x_axis,
limits = xlim,
trans = "log10") +
scale_y_continuous(limits = ylim, labels=formatter) +
guides(colour=guide_legend(title = "Strains",nrow=2)) +
# ggtitle(plot_title) +
xlab(xlabel) +
ylab(expression(paste("Fluorescence x","10"^"3","(a.u.)",sep=""))) +
theme(panel.grid.minor = element_blank(),
legend.direction = "horizontal", legend.position = "none",
panel.border = element_blank(),
axis.line = element_line(),
# axis.text = element_text(size=24),
# axis.title = element_text(size=24),
axis.title = element_text(hjust = 1),
panel.background = element_blank()
)
# geom_rangeframe(aes(x=c(min(x_values):max(x_values)),
#                     y=seq(0,50,length.out=length(c(min(x_values):max(x_values))))),sides = "lb")
return(pretty_plot)
}
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
label_list_control, xlim, ylim, dose_control)
sigmoid_plot
ggsave(sigmoid_plot,filename =  "overlaid.jpeg", path=output_path, height=10, width=15, units = "cm")
descriptives_to_use<-c(1,6,11,16)
control_descriptives_to_use<-c(3,5,8,10,13,15,18,20)
xlim<-c(0.1,200)
dose_control<-c("400","400","200","200","200","200","400","400")
colour_palette<-c("#02085F","#3A05FA","#6E88FC","#91DEFD")
list_of_starting_points<-list(
c(30000,0.8,20,1,5000),
c(7000,0.1,2,1,5000),
c(40000,0.5,5,1,5000),
c(40000,0.5,2,1,5000)
)
# pick which strains/time_points you want to plot, and their labels
frame_list<-descriptives[descriptives_to_use]
label_list_sigmoid<-c("ypethanol","glycerol","proline","sd")
label_list_control<-c("ype_norepressor","ype_70",
"gly_norepressor","gly_70",
"pro_norepressor","pro_70",
"sd_norepressor","sd_70")
control_frame_error<-df_list[control_descriptives_to_use]
# pick your controls
control_frame_list<-descriptives[control_descriptives_to_use]
#define x axis doses and the labels for plotting
doses_experiment<-c(0.1,1,5,20,60,200,400,600)
labels_x_axis<- c("0","1","5","20","60","200","400","600")
# replace 0 values in the doses with 0.1
for(i in c(1:length(frame_list))){
frame_list[[i]][1,8]<-0.1
}
# generate log distributed x values for smoother line fitting.
library(emdbook)
x_values<-lseq(min(frame_list[[1]][,8]),
max(frame_list[[1]][,8]),1000)
strain_list<-label_list_sigmoid
# apply the fitting to each frame with its own individual starting points.
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
label_list_control, xlim, ylim, dose_control)
sigmoid_plot
ggsave(sigmoid_plot,filename =  "overlaid.jpeg", path=output_path, height=10, width=15, units = "cm")
descriptives_to_use<-c(1,6,11,16)
control_descriptives_to_use<-c(3,5,8,10,13,15,18,20)
xlim<-c(0.1,600)
dose_control<-c("400","400","200","200","200","200","400","400")
colour_palette<-c("#02085F","#3A05FA","#6E88FC","#91DEFD")
list_of_starting_points<-list(
c(30000,0.8,20,1,5000),
c(7000,0.1,2,1,5000),
c(40000,0.5,5,1,5000),
c(40000,0.5,2,1,5000)
)
# pick which strains/time_points you want to plot, and their labels
frame_list<-descriptives[descriptives_to_use]
label_list_sigmoid<-c("ypethanol","glycerol","proline","sd")
label_list_control<-c("ype_norepressor","ype_70",
"gly_norepressor","gly_70",
"pro_norepressor","pro_70",
"sd_norepressor","sd_70")
control_frame_error<-df_list[control_descriptives_to_use]
# pick your controls
control_frame_list<-descriptives[control_descriptives_to_use]
#define x axis doses and the labels for plotting
doses_experiment<-c(0.1,1,5,20,60,200,400,600)
labels_x_axis<- c("0","1","5","20","60","200","400","600")
# replace 0 values in the doses with 0.1
for(i in c(1:length(frame_list))){
frame_list[[i]][1,8]<-0.1
}
# generate log distributed x values for smoother line fitting.
library(emdbook)
x_values<-lseq(min(frame_list[[1]][,8]),
max(frame_list[[1]][,8]),1000)
strain_list<-label_list_sigmoid
# apply the fitting to each frame with its own individual starting points.
sigmoid_fit_parameters<-mapply(function_curve_fitting,frame_list,list_of_starting_points,
SIMPLIFY = FALSE)
ec_list<-lapply(sigmoid_fit_parameters,f_ecs)
fit<-lapply(sigmoid_fit_parameters,f_sigmoid_fit,x_values)
sigmoid_plot<-f_plot_sigmoid_curves_overlaid(fit,frame_list, control_frame_list,
label_list_control, xlim, ylim, dose_control)
sigmoid_plot
ggsave(sigmoid_plot,filename =  "overlaid.jpeg", path=output_path, height=10, width=15, units = "cm")
